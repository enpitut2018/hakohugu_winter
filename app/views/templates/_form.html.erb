<%= form_for @template do |f| %>
<%= render 'shared/temp_error_messages' %>
<div class="form-group">
  <%= f.label :title, "アシスタント名" ,class: 'font-weight-bold'%>
  <%= f.text_field :title, class: 'form-control'%>
</div>

<div class="form-group">
  <%= f.label :title, "アシスタント画像" ,class: 'font-weight-bold' %>
  <br>
  <%if @template.picture?%>
    <%if Rails.env.production?%>
      <%= cl_image_tag(@template.picture,:class => 'card-img-top')%>
    <%else%>
	  <%= image_tag @template.picture.url,:class => 'card-img-top'%>
    <%end%>
  <%end%>
  <br>
  <span class = "picture">
    <%= f.file_field :picture, accept: 'image/jpeg,image/gif,image/png' %>
  </span>
</div>

<div class="form-group">
  <%= f.label :topic, "概要" ,class: 'font-weight-bold'%>
  <p>
    誰がどんな目的で何をすることを助けるアシスタントなのかの説明
  </p>
  <%= f.text_field :topic, class: 'form-control'%>
</div>

<div class="form-group">
  <%= fields_for @category do |i| %>
    <%= i.label :name, "カテゴリ" ,class: 'font-weight-bold'%>
    <%= i.text_field :name ,class: 'form-control' , id: :category_name%>
  <% end %>

  <%
=begin%>
 <%= f.collection_select(:category_id, Category.all, :id, :name, {}, {:class => "custom-select"}) %> 
<%
=end%>

</div>

<h3>質問</h3>
<div id="questions">
  <%= f.fields_for :questions do |question| %>
  <%= render 'question_fields', f: question %>
<% end %>
<div class="links">
  <%= link_to_add_association '+質問を追加', f, :questions, class: 'btn btn-light mb-5'%>
</div>
</div>

<div class="actions">
  <%= f.submit @submit, class: "btn btn-primary mb-5"%>
</div>
<% end %>

<script>
$( function() {
  $('#micropost_picture').bind('change', function() {
    var size_in_megabytes = this.files[0].size/1024/1024;
    if (size_in_megabytes > 5) {
      alert('ファイルサイズが上限の5MBを超えています。');
    }
  });

  $( "#category_name" ).autocomplete({
    autoFocus: true,
     source: "/templates/category_auto_complete.json",
      minLength: 1,
    messages: {
      noResults: '',
      results: function() {}
    }
  });
});
</script>